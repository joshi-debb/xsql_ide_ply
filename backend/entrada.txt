-- Comentario
/*
   Comentario multilinea
*/

create data base productos;



SELECT CONCATENAR('HOLA','MUNDO');
SELECT SUBSTRAER('HOLAMUNDO',1,4);
SELECT HOY();
SELECT CONTAR(*) FROM ID WHERE nombre = 'pepito';
SELECT SUMA(IVA) FROM ID WHERE CAMPO1 = 1;
SELECT CAS ( ID AS int );

DECLARE @variable1 int;
DECLARE @variable2 nvarchar(20);


CREATE PROCEDURE procedure_name () AS
CREATE PROCEDURE procedure_name (@Ciudad nvarchar(40), @Departamento nvarchar(10)) AS

exec procedure_name 'Guatemala', 'Guatemala'
exec procedure_name 

CREATE FUNCTION retornarSuma(@ProductoID int)
RETURNS int
AS
BEGIN
    RETURN
END

ALTER TABLE Productos ADD Jugos nvarchar(20);

ALTER TABLE Equipos DROP Goles

INSERT INTO products (product_no, name, price) VALUES (1, 'Cheese', 9.99);

UPDATE products SET price = 10 WHERE price = 5;
UPDATE mytable SET a = 5, b = 3, c = 1 WHERE a = 0 || a < 0;

DELETE FROM products WHERE price = 10;
DELETE FROM products WHERE price = 10 && cantidad != 0;

DROP TABLE nombre_tabla;

TRUNCATE TABLE nombre_tabla;


-- Lo agregue solo para validar que esten bien las operaciones
println(1<3 && 4>2)
println(0+1.2+(3/3)*2)


use productos;

create table papitas(
    nombre NVARCHAR(5) NULL,
    apellido NVARCHAR(5) NOT NULL,
    fecha_nac DATE NOT NULL PRIMARY KEY,
    genero BIT NOT NULL  
);



create data base personas;

use personas;

create table persona (
    nombre NVARCHAR(5) NOT NULL PRIMARY KEY,
    apellido NVARCHAR(5) NOT NULL,
    edad INT NOT NULL,
    fecha DATE NOT NULL  
);

INSERT INTO persona (nombre,apellido,edad,fecha) VALUES ('pepito','papilla',12,'10/12/2023');

DROP TABLE persona;

TRUNCATE TABLE persona;

UPDATE persona SET edad = '18'  WHERE nombre = 'pepito';

UPDATE persona SET edad = '25', apellido = 'zuleta', fecha = '11/03/1996'  WHERE nombre = 'pepito';

DELETE FROM persona WHERE nombre = 'popis';


ALTER TABLE persona DROP nombre;





create table persona (
    nombre NVARCHAR(5) NOT NULL PRIMARY KEY,
    apellido NVARCHAR(5) NOT NULL,
    edad INT NOT NULL,
    fecha DATE NOT NULL  
);

Declare @hola int;
set @hola = 123;
SELECT ("El valor de la variable es: " + @hola + " unidades");

DECLARE @var1 nvarchar(5);
SELECT (@var1);

DECLARE @var2 bit;
set @var2 = 0;

SELECT (4<2 && @hola<1);
SELECT * FROM persona;


IF 0 < 1 THEN
    declare @v2 int;
    SELECT ("Entre a un if");
END IF;

IF 0 > 1 THEN
    declare @v1 int;
    SELECT ("Primer if");

    IF 5 > 1 THEN
        declare @v1 int;
        SELECT ("If anidado");
    ELSE THEN
        declare @v2 bit;
    END IF;

ELSE THEN
    declare @v2 bit;
    SELECT ("Entro al else");
END IF;


IF 4 < 0 THEN
    declare @v1 int;
ELSE IF 3 > 55 THEN
    declare @v2 nvarchar(2);
ELSE THEN
    declare @v3 bit;
END IF;


declare @num int;
set @num = 1;

IF @num == 0 THEN
    declare @v1 int;
    SELECT ("num = " + @num);
ELSE IF @num == 1 THEN
    declare @v2 nvarchar(2);
    SELECT ("num = " + @num);
ELSE IF @num == 2 THEN
    declare @v3 nvarchar(2);
    SELECT ("num = " + @num);
ELSE IF @num == 3 THEN
    declare @v3 nvarchar(2);
    SELECT ("num = " + @num);
ELSE IF @num == 4 THEN
    declare @v3 nvarchar(2);
    SELECT ("num = " + @num);
ELSE THEN
    declare @v3 nvarchar(2);
    SELECT ("num = " + @num);
END IF;

/*
SELECT * FROM tbproductos;
SELECT * FROM tbproductos, tbservicios;
SELECT * FROM tbfactura where id=3;
SELECT precio FROM tbproductos;
SELECT precio FROM tbproductos, tbclientes;
SELECT precio,descripcion FROM tbproductos, tbclientes;
SELECT precio,descripcion FROM tbproductos, tbclientes WHERE precio=0;

SELECT * from tbfactura where fechafactura between '2023-01-01' and '2023-03-03';


SELECT 'hola';
*/



create data base personas;

use personas;

create table persona (
    nombre NVARCHAR(5) NOT NULL PRIMARY KEY,
    apellido NVARCHAR(5) NOT NULL,
    edad INT NOT NULL,
    fecha DATE NOT NULL  
);



DROP TABLE persona;

TRUNCATE TABLE persona;

Declare @hola decimal;
set @hola = 123.12+1;
SELECT ("El valor de la variable es: " + @hola + " unidades");

DECLARE @var1 nvarchar(5);
SELECT (@var1);

DECLARE @var2 bit;
set @var2 = 0;

SELECT (4<2 && @hola<1);
SELECT * FROM persona;


IF 0 < 1 THEN
    declare @v2 int;
    SELECT ("Entre a un if");
END IF;

IF 0 > 1 THEN
    declare @v1 int;
    SELECT ("Primer if");

    IF 5 > 1 THEN
        declare @v1 int;
        SELECT ("If anidado");
    ELSE THEN
        declare @v2 bit;
    END IF;

ELSE THEN
    declare @v2 bit;
    SELECT ("Entro al else");
END IF;

CREATE PROCEDURE sp_conteo (@i int)
AS
BEGIN
    DECLARE @contador int;
    IF 0 > 1 THEN
        declare @v1 int;
        SELECT ("Primer if");

        IF 5 > 1 THEN
            declare @v1 int;
            SELECT ("If anidado");
        ELSE THEN
            declare @v2 bit;
        END IF;

    ELSE THEN
        declare @v2 bit;
        SELECT ("Entro al else");
    END IF;
END;

CREATE PROCEDURE sp_nuevoprocedimiento(@MONTO 
DECIMAL,@IDFACTURA AS INT)
AS
BEGIN 
DECLARE @IVA DECIMAL;
 DECLARE @ISR DECIMAL;
 
 SET @IVA = @MONTO - @MONTO/1.12;
 IF @MONTO > 2000 THEN 
 SET @ISR = @MONTO *0.07;
ELSE then
 SET @ISR = @MONTO *0.10;
 END IF;
 
 UPDATE tbfactura set monto = @monto where idfactura = @idfactura;
END;

CREATE PROCEDURE sp_conteo (@i AS int)
AS
    BEGIN
    DECLARE @contador AS int;
    if(@i != 0) then
        WHILE @contador < @i
        BEGIN
            SELECT CONCATENAR(" EJECUCION No.",@i);
            SET @i= @i+1;
        END;
    ELSE then
        SELECT "NO HAY NADA QUE HACER";
    end if;
END;









---------- TABLAS E INSERTS ESTAN BUENOS --------------------------------------------------------


create data base personas;

use personas;

create table persona (
    nombre NVARCHAR(5) NOT NULL PRIMARY KEY,
    apellido NVARCHAR(5) NOT NULL,
    edad INT NOT NULL,
    altura DECIMAL NOT NULL,
    fecha DATE NOT NULL  
);

INSERT INTO persona (nombre, apellido, edad, fecha, altura) VALUES ('juanito', 'cascabel', 17, '01/11/2005', 1.80);
INSERT INTO persona (nombre, apellido, edad, fecha, altura) VALUES ('lola', 'molinillo', 18, '05/03/2004', 1.55);
INSERT INTO persona (nombre, apellido, edad, fecha, altura) VALUES ('carlitos', 'travesura', 19, '09/08/2003', 1.65);
INSERT INTO persona (nombre, apellido, edad, fecha, altura) VALUES ('maria', 'santos', 20, '11/01/2002', 1.77);
INSERT INTO persona (nombre, apellido, edad, fecha, altura) VALUES ('pedrito', 'flores', 21, '03/02/2001', 1.71);


create table alumno (
    nombre NVARCHAR(5) NOT NULL PRIMARY KEY,
    apellido NVARCHAR(5) NOT NULL,
    registro INT NOT NULL,
    altura DECIMAL NOT NULL,
    grado NVARCHAR(5) NOT NULL    
);


INSERT INTO alumno (nombre, apellido, registro, grado, altura) VALUES ('juan', 'lopez', 1001, '1A', 1.80);
INSERT INTO alumno (nombre, apellido, registro, grado, altura) VALUES ('ana', 'gomez', 1002, '2B', 1.55);
INSERT INTO alumno (nombre, apellido, registro, grado, altura) VALUES ('carlos', 'perez', 1003, '3C', 1.65);
INSERT INTO alumno (nombre, apellido, registro, grado, altura) VALUES ('maria', 'martinez', 1004, '4D', 1.77);
INSERT INTO alumno (nombre, apellido, registro, grado, altura) VALUES ('pedro', 'rodriguez', 1005, '5E', 1.71);


--------------SELECT CORRECTOS -------------------

SELECT * FROM persona;

SELECT * FROM persona WHERE edad > 20;

SELECT * FROM persona, nombre_otra_tabla WHERE edad > 20;
SELECT * FROM persona, nombre_otra_tabla WHERE edad > 20 && edad < 80;

SELECT * FROM persona
WHERE fecha BETWEEN '01/01/2004' && HOY();

SELECT * FROM persona
WHERE edad BETWEEN '12' && '18';

SELECT * FROM persona
WHERE altura BETWEEN '1.5' && '1.8';

--------------------------------------------------------------------

DROP TABLE persona;

TRUNCATE TABLE persona;

UPDATE persona SET edad = '18'  WHERE nombre = 'pepito';

UPDATE persona SET edad = '25', apellido = 'zuleta', fecha = '11/03/1996'  WHERE nombre = 'pepito';

DELETE FROM persona WHERE nombre = 'popis';

ALTER TABLE persona ADD estado_civil NVARCHAR(20);

ALTER TABLE persona DROP nombre;


SELECT CONTAR(*) FROM persona WHERE edad >= 18;

SELECT SUMA(edad) FROM persona WHERE altura > 1.2;

-- si da tiempo agrerar operaciones con fecha a where simple en consulta select